<!--==================================================
| FILE: mission_specification_test.xml
| BRIEF: A mission specification example.
| DETAILS:
|   This file includes basic movements to search in 
|   an area and Aruco visual markers recognition.
|   The vehicle flips when an Aruco visual marker has
|   been found.
| AUTHORS:
|    Adrian Diaz
===================================================-->
<mission name="Mission specification example">
  
<!--==================================================
| TASK: Initial phase
===================================================-->
  <task name="Initial phase">
    <task name="Taking off">
      <action name="TAKE_OFF"/>
    </task>
    <task name="Stabilizing at origin">
      <action name="STABILIZE"/>
    </task>
    <task name="Setting up HOME point ">
      <action name="REMEMBER_POINT">
        <argument name="point_name" value="HOME"/>
      </action>
    </task>
    <task name="Hovering for 3 seconds">
      <action name="HOVER">
        <argument name="duration" value="3"/>
      </action>
    </task>
  </task>

<!--==================================================
| TASK: Search object
===================================================-->
  <task name="Searching Aruco identifiers">  
    <task name="Moving to A1">
      <action name="MOVE">
        <argument name="point" value="(1, 0, 0)"/>
      </action>
    </task>
    <task name="Stabilizing at point A">
      <action name="STABILIZE"/>
    </task>
    <task name="Moving to A2">
      <action name="MOVE">
        <argument name="point" value="(0, 1, 0)"/>
      </action>
    </task>
    <task name="Stabilizing at point B">
      <action name="STABILIZE"/>
    </task>

    <task name="Moving to  point C">
      <action name="MOVE">
        <argument name="point" value="(-1, 0, 0)"/>
      </action>
    </task>
    <task name="Stabilizing at point C">
      <action name="STABILIZE"/>
    </task>
  </task>

<!--==================================================
| TASK: Final phase
===================================================-->
  
  <task name="final phase">
    <task name="Going to HOME">
      <action name="GO_TO_POINT">
        <argument name="point_name" value="HOME"/>
      </action>
    </task>

    <task name="Final landing">
      <action name="LAND"/>
    </task>
  </task>

<!--==================================================
| EXCEPTIONS
===================================================-->
  <event_handling>
<!--==================================================
| EVENT: Object found
===================================================-->
    <event name="object found">
      <condition parameter="ArucoVisualMarker" comparison="equal" value="0"/>
      <action name="STABILIZE"/> 
      <action name="FLIP_FRONT"/>
      <action name="STABILIZE"/>
      <ending step="REPEAT_TASK"/>
    </event>

<!--==================================================
| EVENT: Low battery
===================================================-->
    <event name="low battery">
      <condition parameter="percentageBatteryCharge" comparison="less" value="20"/>
      <action name="LAND"/>   
      <ending step="ABORT_MISSION"/>
    </event>

  </event_handling>
</mission>